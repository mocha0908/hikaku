<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒˆãƒ¬ã‚«ã‚­ãƒ³ã‚°ãƒ€ãƒ  è²·å–æ¯”è¼ƒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Roboto:wght@500;700;900&display=swap" rel="stylesheet">
  
  <style>
    :root {
      /* ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ */
      --primary: #0066cc;       /* ãƒ¡ã‚¤ãƒ³ã‚«ãƒ©ãƒ¼ */
      --primary-bg: #eef4ff;    /* è–„ã„é’èƒŒæ™¯ */
      --accent: #e60012;        /* å¼·èª¿ï¼ˆãƒ©ãƒƒã‚·ãƒ¥ç­‰ï¼‰ */
      --bg: #f4f7f9;            /* å…¨ä½“ã®èƒŒæ™¯ */
      --text: #333;
      --border: #dde2e5;
      --shadow: 0 4px 12px rgba(0,0,0,0.08);
      
      /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®š */
      --header-h: 60px;
      --search-h: 70px;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body { font-family: 'Noto Sans JP', sans-serif; margin: 0; background: var(--bg); color: var(--text); padding-bottom: 60px; }

    /* --- 1. ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¨ãƒªã‚¢ --- */
    header {
      background: #fff; height: var(--header-h); display: flex; align-items: center; justify-content: center;
      border-bottom: 1px solid var(--border); position: relative; z-index: 10;
    }
    h1 { font-size: 18px; margin: 0; color: var(--primary); font-weight: 900; letter-spacing: 0.05em; }
    h1 span { color: #555; font-weight: normal; font-size: 13px; margin-left: 8px; }

    /* --- 2. æ¤œç´¢ãƒãƒ¼ (Sticky) --- */
    .search-area {
      position: sticky; top: 0; z-index: 100;
      background: rgba(244, 247, 249, 0.9); backdrop-filter: blur(8px);
      padding: 10px 16px; border-bottom: 1px solid rgba(0,0,0,0.05);
    }
    .search-box {
      max-width: 800px; margin: 0 auto; display: flex; gap: 8px;
    }
    .input-group {
      flex: 1; display: flex; align-items: center; background: #fff;
      border: 1px solid var(--border); border-radius: 50px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.03); transition: all 0.2s;
    }
    .input-group:focus-within { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(0,102,204,0.1); }
    /* iOSã§ã‚ºãƒ¼ãƒ ã—ãªã„ã‚ˆã†ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º16pxç¢ºä¿ */
    .input-group input {
      border: none; background: transparent; padding: 12px 16px; font-size: 16px; flex: 1; outline: none; border-radius: 50px;
    }
    .btn-search {
      width: 46px; height: 46px; border-radius: 50%; border: none;
      background: var(--primary); color: #fff; cursor: pointer; flex-shrink: 0;
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 3px 8px rgba(0,102,204,0.3); transition: transform 0.1s;
    }
    .btn-search:active { transform: scale(0.92); }
    .btn-search svg { fill: #fff; width: 22px; height: 22px; }

    /* --- 3. ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒƒãƒ— (æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«) --- */
    .controls { max-width: 1200px; margin: 0 auto; padding: 10px 16px 0; }
    .scroll-row {
      display: flex; gap: 8px; overflow-x: auto; padding-bottom: 5px;
      scrollbar-width: none; /* Firefox hide scrollbar */
    }
    .scroll-row::-webkit-scrollbar { display: none; }
    
    .chip {
      background: #fff; border: 1px solid var(--border); border-radius: 20px;
      padding: 0 14px; height: 36px; display: flex; align-items: center; gap: 6px;
      font-size: 13px; white-space: nowrap; flex-shrink: 0; color: #555; cursor: pointer;
    }
    .chip.active { background: var(--primary); color: #fff; border-color: var(--primary); }
    .chip select, .chip input {
      border: none; background: transparent; outline: none; font-size: 13px; color: inherit; font-weight: 500;
    }
    .chip input { width: 80px; }
    .chip input::placeholder { color: #aaa; }
    .chip.active input::placeholder { color: rgba(255,255,255,0.7); }

    /* --- 4. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ --- */
    #content { max-width: 1200px; margin: 0 auto; padding: 16px; min-height: 400px; }

    /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
    .spinner { display: none; justify-content: center; padding: 40px; color: #999; font-size: 14px; gap: 10px; align-items: center; }
    .spin-icon { width: 24px; height: 24px; border: 3px solid #ddd; border-top-color: var(--primary); border-radius: 50%; animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* =========================================
       [VIEW 1] ã‚¹ãƒãƒ›ç”¨ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)
       ========================================= */
    .card-grid { display: grid; gap: 16px; }
    
    /* PCã§ã¯ã‚«ãƒ¼ãƒ‰ã‚’éš ã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã™ã‚‹ */
    @media (min-width: 769px) { .card-grid { display: none; } }

    .card {
      background: #fff; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.04);
      overflow: hidden; display: grid; grid-template-columns: 80px 1fr;
    }
    .c-img {
      background: #fafafa; display: flex; align-items: center; justify-content: center; cursor: zoom-in;
    }
    .c-img img { width: 100%; height: 100%; object-fit: contain; padding: 4px; }
    
    .c-body { padding: 12px; display: flex; flex-direction: column; gap: 8px; }
    .c-title {
      font-size: 14px; font-weight: bold; line-height: 1.4;
      display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
    }
    
    /* ä¾¡æ ¼ã‚°ãƒªãƒƒãƒ‰ */
    .c-prices {
      display: grid; grid-template-columns: repeat(5, 1fr); gap: 4px;
      background: var(--primary-bg); border-radius: 6px; padding: 6px; text-align: center;
    }
    .cp-col { display: flex; flex-direction: column; }
    .cp-lbl { font-size: 9px; color: var(--primary); font-weight: bold; }
    .cp-val { font-family: 'Roboto', sans-serif; font-weight: bold; font-size: 12px; color: #333; }
    .cp-val.empty { color: #ccc; font-weight: normal; }

    /* ãƒ©ãƒƒã‚·ãƒ¥ä¾¡æ ¼ */
    .c-rush {
      grid-column: 1 / -1; background: #fff5f5; border-top: 1px dashed #ffd1d1;
      padding: 8px 12px; display: flex; justify-content: space-between; align-items: center;
    }
    .rush-tag { font-size: 11px; font-weight: bold; color: var(--accent); display: flex; align-items: center; gap: 4px; }
    .rush-p { font-family: 'Roboto', sans-serif; font-weight: 900; font-size: 18px; color: var(--accent); }

    /* =========================================
       [VIEW 2] PCç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ (769pxä»¥ä¸Š)
       ========================================= */
    .pc-table-wrap { display: none; } /* ã‚¹ãƒãƒ›ã§ã¯éš ã™ */
    
    @media (min-width: 769px) {
      .pc-table-wrap {
        display: block; background: #fff; border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05); overflow: hidden; border: 1px solid var(--border);
      }
      table.data-tbl { width: 100%; border-collapse: collapse; font-size: 14px; }
      
      /* å›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ */
      .data-tbl th {
        background: #f8f9fa; padding: 12px; font-weight: bold; color: #555;
        border-bottom: 2px solid #ddd; text-align: center; white-space: nowrap;
        position: sticky; top: var(--search-h); z-index: 50; /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ã‚‚ãƒ˜ãƒƒãƒ€ãƒ¼ãŒæ®‹ã‚‹ */
      }
      .data-tbl td {
        padding: 10px 12px; border-bottom: 1px solid #eee; text-align: center; vertical-align: middle;
      }
      .data-tbl tr:hover { background: #f0f8ff; } /* ãƒ›ãƒãƒ¼ã§è¡Œå¼·èª¿ */
      
      .col-left { text-align: left !important; }
      .col-rush { background: #fff0f0; color: var(--accent); font-weight: bold; border-left: 2px solid #ffebeb; }
      th.col-rush { background: #ffe6e6; }
      
      .t-img { width: 40px; height: 40px; object-fit: contain; border: 1px solid #eee; border-radius: 4px; background:#fff; cursor: zoom-in; }
      .p-cell { font-family: 'Roboto', sans-serif; font-weight: bold; }
    }

    /* å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ */
    .clickable { cursor: pointer; transition: color 0.1s; }
    .clickable:hover { color: var(--primary); text-decoration: underline; }
    .copy-btn {
      display: inline-block; background: #eee; color: #666; font-size: 10px; padding: 2px 6px;
      border-radius: 4px; margin-left: 6px; cursor: pointer; vertical-align: middle;
    }
    .copy-btn:hover { background: #ddd; color: #333; }
    mark { background: #fff2cc; color: inherit; padding: 0 2px; border-radius: 2px; }

    /* ãƒ¢ãƒ¼ãƒ€ãƒ« */
    #modal { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: none; align-items: center; justify-content: center; z-index: 9999; backdrop-filter: blur(2px); }
    #modal img { max-width: 90%; max-height: 90%; border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
    
    /* ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ */
    #toast {
      position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(20px);
      background: #333; color: #fff; padding: 10px 20px; border-radius: 30px; font-size: 13px;
      opacity: 0; visibility: hidden; transition: all 0.3s; z-index: 10000;
    }
    #toast.show { opacity: 1; visibility: visible; transform: translateX(-50%) translateY(0); }

    /* æœ€ä½ä¿è¨¼ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ */
    .guarantee { background: #fff; border-radius: 8px; margin-top: 10px; border: 1px solid var(--border); }
    .guarantee summary { padding: 12px 16px; font-weight: bold; font-size: 13px; cursor: pointer; outline: none; color: var(--primary); }
    .g-content { padding: 0 16px 16px; overflow-x: auto; }
    .g-tbl { width: 100%; border-collapse: collapse; font-size: 12px; text-align: center; }
    .g-tbl th { background: #f0f0f0; border: 1px solid #ddd; padding: 6px; }
    .g-tbl td { border: 1px solid #eee; padding: 6px; }
    .g-head { background: #fafafa; color: var(--primary); font-weight: bold; text-align: left; }

    /* ãƒšãƒ¼ã‚¸ãƒ£ãƒ¼ */
    .pager { display: flex; justify-content: center; gap: 8px; margin-top: 30px; }
    .pager button {
      width: 40px; height: 40px; border-radius: 8px; border: 1px solid #ddd; background: #fff;
      cursor: pointer; font-size: 16px; color: #555;
    }
    .pager button:hover { background: #f9f9f9; }
    .pager button:disabled { opacity: 0.3; cursor: default; }

  </style>
</head>
<body>

  <header>
    <h1>ãƒˆãƒ¬ã‚«ã‚­ãƒ³ã‚°ãƒ€ãƒ  <span>è²·å–æ¯”è¼ƒ</span></h1>
  </header>

  <div class="search-area">
    <div class="search-box">
      <div class="input-group">
        <input type="text" id="keyword" placeholder="ã‚«ãƒ¼ãƒ‰åãƒ»å‹ç•ª (ã‚¹ãƒšãƒ¼ã‚¹ã§AND)" enterkeyhint="search">
      </div>
      <button class="btn-search" onclick="search()"><svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 3 13.09 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg></button>
    </div>
  </div>

  <div class="controls">
    <div class="scroll-row">
      <div class="chip">ğŸ“‚ <select id="categorySelect"><option value="">å…¨ã‚«ãƒ†ã‚´ãƒª</option></select></div>
      <div class="chip" id="chipThr">Â¥ <input type="number" id="thresholdInput" placeholder="ä¸‹é™(å††)"></div>
      <div class="chip" onclick="toggleSort()"><span id="sortIcon">â‡…</span> <span id="sortLabel">æ¨™æº–é †</span></div>
      <div class="chip">ğŸ“„ <select id="pageSizeSelect"><option value="50">50ä»¶</option><option value="100" selected>100ä»¶</option><option value="200">200ä»¶</option></select></div>
    </div>
    
    <div class="scroll-row" id="initialBar" style="margin-top:8px"></div>

    <details class="guarantee">
      <summary>âš¡ æœ€ä½ä¿è¨¼ä¾¡æ ¼è¡¨ (ã‚¿ãƒƒãƒ—ã§é–‹é–‰)</summary>
      <div class="g-content">
        <table class="g-tbl">
          <thead><tr><th>ã‚«ãƒ¼ãƒ‰</th><th>A</th><th>A-</th><th>B</th><th>C</th><th>D</th></tr></thead>
          <tbody>
            <tr><td class="g-head">PSA10</td><td>5,000</td><td>4,000</td><td>3,000</td><td>2,000</td><td>1,000</td></tr>
            <tr><td class="g-head">SAR</td><td>400</td><td>300</td><td>200</td><td>100</td><td>50</td></tr>
            <tr><td class="g-head">SR</td><td>200</td><td>150</td><td>100</td><td>50</td><td>20</td></tr>
            <tr><td class="g-head">AR</td><td>220</td><td>150</td><td>70</td><td>30</td><td>10</td></tr>
            <tr><td class="g-head">RR</td><td>10</td><td>5</td><td>5</td><td>1</td><td>1</td></tr>
          </tbody>
        </table>
      </div>
    </details>
  </div>

  <div id="content">
    <div id="spinner" class="spinner"><div class="spin-icon"></div>æ¤œç´¢ã—ã¦ã„ã¾ã™...</div>
    
    <div id="mobileView" class="card-grid"></div>
    <div id="pcView" class="pc-table-wrap"></div>
    
    <div id="pager" class="pager"></div>
  </div>

  <div id="modal" onclick="this.style.display='none'"><img id="modalImg" src=""></div>
  <div id="toast">âœ… ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ</div>

  <script>
    // â–¼â–¼â–¼ ã‚ãªãŸã®GASã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªURLã«æ›¸ãæ›ãˆã¦ãã ã•ã„ â–¼â–¼â–¼
    const API_URL = "https://script.google.com/macros/s/XXXXXXXXXXXXXXXXXXXXXXXXXXXX/exec"; 
    // â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²

    const state = {
      rows: [], filtered: [], page: 1, pageSize: 100,
      sort: { idx: 0, dir: 'asc' },
      terms: { and:[], or:[] },
      threshold: 0, initial: 'ALL'
    };

    const INITIALS = [
      {k:'ALL',l:'å…¨ã¦'},{k:'A',l:'ã‚'},{k:'K',l:'ã‹'},{k:'S',l:'ã•'},{k:'T',l:'ãŸ'},
      {k:'N',l:'ãª'},{k:'H',l:'ã¯'},{k:'M',l:'ã¾'},{k:'Y',l:'ã‚„'},{k:'R',l:'ã‚‰'},{k:'W',l:'ã‚'},{k:'MISC',l:'ä»–'}
    ];

    document.addEventListener('DOMContentLoaded', () => {
      // ã‚«ãƒ†ã‚´ãƒªãƒ­ãƒ¼ãƒ‰
      fetch(API_URL + "?action=categories")
        .then(r=>r.json()).then(list => {
          const s = document.getElementById('categorySelect');
          list.forEach(c => { const o = document.createElement('option'); o.value=c; o.text=c; s.appendChild(o); });
        }).catch(e=>console.log(e));

      buildInitials();
      setupEvents();
      search(); // åˆæœŸãƒ­ãƒ¼ãƒ‰
    });

    function setupEvents(){
      document.getElementById('keyword').addEventListener('keydown', e => { if(e.key==='Enter') search(); });
      document.getElementById('categorySelect').addEventListener('change', search);
      document.getElementById('thresholdInput').addEventListener('input', e => {
        state.threshold = Number(e.target.value) || 0;
        document.getElementById('chipThr').classList.toggle('active', state.threshold > 0);
        render();
      });
      document.getElementById('pageSizeSelect').addEventListener('change', e => {
        state.pageSize = Number(e.target.value); state.page=1; render();
      });
    }

    function buildInitials(){
      const d = document.getElementById('initialBar');
      d.innerHTML = '';
      INITIALS.forEach(i => {
        const c = document.createElement('div');
        c.className = `chip ${state.initial===i.k?'active':''}`;
        c.innerText = i.l;
        c.onclick = () => { state.initial = i.k; buildInitials(); render(); };
        d.appendChild(c);
      });
    }

    function search(){
      const kw = document.getElementById('keyword').value.trim();
      const cat = document.getElementById('categorySelect').value;
      const spin = document.getElementById('spinner');

      spin.style.display = 'flex';
      document.getElementById('mobileView').innerHTML = '';
      document.getElementById('pcView').innerHTML = '';
      document.getElementById('pager').innerHTML = '';

      // ã‚¯ã‚¨ãƒªè§£æ
      const norm = (kw||"").replace(/[\u3041-\u3096]/g,c=>String.fromCharCode(c.charCodeAt(0)+0x60)).toLowerCase();
      if(norm.includes('|')) { state.terms = {and:[], or:norm.split('|').filter(Boolean)}; }
      else { state.terms = {and:norm.split(/\s+/).filter(Boolean), or:[]}; }

      const u = `${API_URL}?action=search&keyword=${encodeURIComponent(kw)}&category=${encodeURIComponent(cat)}`;
      fetch(u).then(r=>r.json()).then(data => {
        spin.style.display = 'none';
        state.rows = data.rows || [];
        state.page = 1;
        state.sort = { idx: 0, dir: 'asc' };
        updateSortLabel();
        
        if(!state.rows.length) {
          document.getElementById('mobileView').innerHTML = `<div style="text-align:center;padding:40px;color:#aaa">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>`;
        } else {
          render();
        }
      }).catch(e => {
        spin.style.display = 'none';
        alert("ã‚¨ãƒ©ãƒ¼: " + e.message);
      });
    }

    function render(){
      // 1. ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
      let list = state.rows;
      if(state.threshold > 0) list = list.filter(r => { const p=Number(r[2]); return isNaN(p) || p >= state.threshold; });
      if(state.initial !== 'ALL') list = list.filter(r => getInitial(r[0]) === state.initial);

      // 2. ã‚½ãƒ¼ãƒˆ
      const {idx, dir} = state.sort;
      list.sort((a,b) => {
        const va=a[idx], vb=b[idx];
        const isNum = idx >= 2;
        if(isNum) return ((Number(va)||0)-(Number(vb)||0)) * (dir==='asc'?1:-1);
        return String(va||"").localeCompare(String(vb||""),'ja') * (dir==='asc'?1:-1);
      });
      state.filtered = list;

      // 3. ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
      const total = list.length;
      const maxP = Math.ceil(total / state.pageSize) || 1;
      if(state.page > maxP) state.page = 1;
      const start = (state.page-1)*state.pageSize;
      const view = list.slice(start, start + state.pageSize);

      renderMobile(view);
      renderPC(view);
      renderPager(state.page, maxP);
    }

    function renderMobile(rows){
      const t = document.getElementById('mobileView');
      let h = '';
      rows.forEach(r => {
        const [name, img, pA, pAm, pB, pC, pD, pRush] = r;
        const safeName = highlight(name);
        const {copyTxt, copyLbl} = parseName(name);
        
        // ç”»åƒ
        const imgTag = (img && /^http/.test(img)) ? `<img src="${img}" loading="lazy" onclick="zoom('${img}')">` : `<span style="font-size:10px;color:#ccc">NO IMG</span>`;
        
        // ä¾¡æ ¼ã‚°ãƒªãƒƒãƒ‰
        const prices = [ {l:'A',v:pA}, {l:'A-',v:pAm}, {l:'B',v:pB}, {l:'C',v:pC}, {l:'D',v:pD} ];
        let pHtml = '';
        prices.forEach(x => {
          const v = fmt(x.v);
          const cls = (x.v && !isNaN(x.v)) ? 'clickable' : 'empty';
          const clk = (x.v && !isNaN(x.v)) ? `onclick="copy('${x.v}')"` : '';
          pHtml += `<div class="cp-col" ${clk}><span class="cp-lbl">${x.l}</span><span class="cp-val ${cls}">${v}</span></div>`;
        });

        // ãƒ©ãƒƒã‚·ãƒ¥
        let rushHtml = '';
        if(pRush) {
          const rv = fmt(pRush);
          const rclk = (pRush && !isNaN(pRush)) ? `onclick="copy('${pRush}')"` : '';
          rushHtml = `<div class="c-rush" ${rclk}>
            <span class="rush-tag">ğŸ”¥ ã‚«ãƒ¼ãƒ‰ãƒ©ãƒƒã‚·ãƒ¥(A)</span>
            <span class="rush-p clickable">Â¥${rv}</span>
          </div>`;
        }

        h += `<div class="card">
          <div class="c-img">${imgTag}</div>
          <div class="c-body">
            <div class="c-title">${safeName}<span class="copy-btn" onclick="copy('${copyTxt.replace(/'/g,"\\'")}','${copyLbl}ã‚³ãƒ”ãƒ¼')">${copyLbl}</span></div>
            <div class="c-prices">${pHtml}</div>
          </div>
          ${rushHtml}
        </div>`;
      });
      t.innerHTML = h;
    }

    function renderPC(rows){
      const t = document.getElementById('pcView');
      if(window.innerWidth < 769) { t.innerHTML=''; return; }

      let h = `<table class="data-tbl"><thead><tr>
        <th class="col-left">ã‚«ãƒ¼ãƒ‰å</th><th>ç”»åƒ</th>
        <th>çŠ¶æ…‹A</th><th>çŠ¶æ…‹A-</th><th>çŠ¶æ…‹B</th><th>çŠ¶æ…‹C</th><th>çŠ¶æ…‹D</th>
        <th class="col-rush">ãƒ©ãƒƒã‚·ãƒ¥(A)</th>
      </tr></thead><tbody>`;

      rows.forEach(r => {
        const [name, img, pA, pAm, pB, pC, pD, pRush] = r;
        const {copyTxt, copyLbl} = parseName
